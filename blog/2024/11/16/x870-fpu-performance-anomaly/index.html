
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Yet another FutsÅ« no Material for MkDocs site">
      
      
        <meta name="author" content="YooLc">
      
      
        <link rel="canonical" href="https://yoolc.github.io/notes/blog/2024/11/16/x870-fpu-performance-anomaly/">
      
      
        <link rel="prev" href="../../../09/12/blechley-park-trip/">
      
      
        <link rel="next" href="../../../12/02/foss-inspiration/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS è®¢é˜…" href="../../../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="å·²æ›´æ–°å†…å®¹çš„ RSS è®¢é˜…" href="../../../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Intel x87 FPU æµ®ç‚¹æ•°è¿ç®—æ€§èƒ½å¼‚å¸¸åˆ†æ - ç¬”è®°</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=LXGW+WenKai+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"LXGW WenKai Screen";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../fonts/fonts.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/auto_counter.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/theme.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/mkdocs-plugins-v1.1.0.css">
    
      <link rel="stylesheet" href="../../../../../stylesheets/md-post.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lxgw-wenkai-screen-webfont/1.7.0/style.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="goblue" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#intel-x87-fpu-æµ®ç‚¹æ•°è¿ç®—æ€§èƒ½å¼‚å¸¸åˆ†æ" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../../../../.." title="ç¬”è®°" class="md-header__button md-logo" aria-label="ç¬”è®°" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ç¬”è®°
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Intel x87 FPU æµ®ç‚¹æ•°è¿ç®—æ€§èƒ½å¼‚å¸¸åˆ†æ
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="goblue" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="åˆ†äº«" aria-label="åˆ†äº«" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="æ¸…ç©ºå½“å‰å†…å®¹" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/YooLc/notes" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    YooLc/notes
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../.." class="md-tabs__link">
          
  
    
  
  é¦–é¡µ

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
    
  
  ğŸ”¥ åšå®¢

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../courses/24fall/computer-architecture/" class="md-tabs__link">
          
  
    
  
  ğŸ“ è¯¾ç¨‹ç¬”è®°

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../architecture/" class="md-tabs__link">
          
  
    
  
  ğŸš€ ä½“ç³»ç»“æ„

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="ç¬”è®°" class="md-nav__button md-logo" aria-label="ç¬”è®°" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ç¬”è®°
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/YooLc/notes" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    YooLc/notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    é¦–é¡µ
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            é¦–é¡µ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ğŸ”¥ åšå®¢
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            ğŸ”¥ åšå®¢
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    å½’æ¡£
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            å½’æ¡£
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    åˆ†ç±»
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            åˆ†ç±»
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/foss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FOSS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/x86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    x86
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/%E5%AF%86%E7%A0%81%E5%AD%A6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¯†ç å­¦
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è®¡ç®—æœºä½“ç³»ç»“æ„
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è®¡ç®—æœºç§‘å­¦
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ğŸ“ è¯¾ç¨‹ç¬”è®°
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            ğŸ“ è¯¾ç¨‹ç¬”è®°
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    å¤§ä¸‰
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            å¤§ä¸‰
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../courses/24fall/computer-architecture/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    è®¡ç®—æœºä½“ç³»ç»“æ„
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            è®¡ç®—æœºä½“ç³»ç»“æ„
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/computer-architecture/chapter-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    I - è®¡ç®—æœºè®¾è®¡åŸºç¡€
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/computer-architecture/chapter-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    II - æµæ°´çº¿
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/computer-architecture/chapter-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    III - å†…å­˜å±‚æ¬¡ç»“æ„
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/computer-architecture/chapter-4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IV - æŒ‡ä»¤å¹¶è¡Œ (ILP)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/computer-architecture/chapter-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V - çº¿ç¨‹å¹¶è¡Œ (TLP)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../courses/24fall/assembly-and-interface/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    æ±‡ç¼–ä¸æ¥å£
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            æ±‡ç¼–ä¸æ¥å£
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/assembly-and-interface/chapter-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é¢„å¤‡çŸ¥è¯†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/assembly-and-interface/chapter-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¾®å¤„ç†å™¨åŠå…¶ç»“æ„
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/assembly-and-interface/chapter-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¯»å€æ–¹å¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/assembly-and-interface/chapter-4-6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    x86 æ±‡ç¼–æŒ‡ä»¤
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/assembly-and-interface/chapter-9-11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¥å£
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/assembly-and-interface/note/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬”è®°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/assembly-and-interface/final/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æœŸæœ«å†å¹´å·
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../courses/24fall/applied-operations-research/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    åº”ç”¨è¿ç­¹å­¦åŸºç¡€
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            åº”ç”¨è¿ç­¹å­¦åŸºç¡€
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../courses/24fall/computer-network/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    è®¡ç®—æœºç½‘ç»œ
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            è®¡ç®—æœºç½‘ç»œ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../courses/24fall/operating-system/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    æ“ä½œç³»ç»Ÿ
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_5" id="__nav_3_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_5">
            <span class="md-nav__icon md-icon"></span>
            æ“ä½œç³»ç»Ÿ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/operating-system/note/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¬”è®°
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../courses/24fall/principles-of-programming-languages/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ç¼–ç¨‹è¯­è¨€åŸç†
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_6" id="__nav_3_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_6">
            <span class="md-nav__icon md-icon"></span>
            ç¼–ç¨‹è¯­è¨€åŸç†
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/principles-of-programming-languages/practice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è¯¾ä»¶ä¾‹é¢˜
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../courses/24fall/theory-of-computation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    è®¡ç®—ç†è®º
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_7" id="__nav_3_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_7">
            <span class="md-nav__icon md-icon"></span>
            è®¡ç®—ç†è®º
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../courses/24fall/theory-of-computation/undecidability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æœŸæœ«å¤ä¹ 
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../architecture/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ğŸš€ ä½“ç³»ç»“æ„
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ğŸš€ ä½“ç³»ç»“æ„
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#æµ®ç‚¹æ•°ä¹˜æ³•çš„æ€§èƒ½å¼‚å¸¸" class="md-nav__link">
    <span class="md-ellipsis">
      æµ®ç‚¹æ•°ä¹˜æ³•çš„æ€§èƒ½å¼‚å¸¸
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8087-ä¸-x87-æµ®ç‚¹è¿ç®—å•å…ƒ" class="md-nav__link">
    <span class="md-ellipsis">
      8087 ä¸ x87 æµ®ç‚¹è¿ç®—å•å…ƒ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8087-ä¸-8086-çš„åŒæ­¥" class="md-nav__link">
    <span class="md-ellipsis">
      8087 ä¸ 8086 çš„åŒæ­¥
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ç°ä»£-x86-å¤„ç†å™¨ä¸-x87-ç›¸å…³çš„æ§åˆ¶ä½åŠå¼‚å¸¸" class="md-nav__link">
    <span class="md-ellipsis">
      ç°ä»£ x86 å¤„ç†å™¨ä¸ x87 ç›¸å…³çš„æ§åˆ¶ä½åŠå¼‚å¸¸
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ieee-754-æ ‡å‡†" class="md-nav__link">
    <span class="md-ellipsis">
      IEEE 754 æ ‡å‡†
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IEEE 754 æ ‡å‡†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#æ‰©å±•ç²¾åº¦æ ¼å¼" class="md-nav__link">
    <span class="md-ellipsis">
      æ‰©å±•ç²¾åº¦æ ¼å¼
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#éæ­£è§„æ•°çš„è¿ç®—" class="md-nav__link">
    <span class="md-ellipsis">
      éæ­£è§„æ•°çš„è¿ç®—
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    å›åˆ°ä¸»é¡µ
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    å…ƒæ•°æ®
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2024-11-16 00:00:00+00:00" class="md-ellipsis">2024å¹´11æœˆ16æ—¥</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            åˆ†ç±»äº
                            
                              <a href="../../../../category/x86/">x86</a>, 
                              <a href="../../../../category/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/">è®¡ç®—æœºä½“ç³»ç»“æ„</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              éœ€è¦ 10 åˆ†é’Ÿé˜…è¯»æ—¶é—´
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        

  
    <a href="https://github.com/YooLc/notes/-/tree/main/docs/blog/posts/x87.md" title="ç¼–è¾‘æ­¤é¡µ" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="intel-x87-fpu-æµ®ç‚¹æ•°è¿ç®—æ€§èƒ½å¼‚å¸¸åˆ†æ">Intel x87 FPU æµ®ç‚¹æ•°è¿ç®—æ€§èƒ½å¼‚å¸¸åˆ†æ<a class="headerlink" href="#intel-x87-fpu-æµ®ç‚¹æ•°è¿ç®—æ€§èƒ½å¼‚å¸¸åˆ†æ" title="Permanent link">&para;</a></h1>
<h2 id="æµ®ç‚¹æ•°ä¹˜æ³•çš„æ€§èƒ½å¼‚å¸¸">æµ®ç‚¹æ•°ä¹˜æ³•çš„æ€§èƒ½å¼‚å¸¸<a class="headerlink" href="#æµ®ç‚¹æ•°ä¹˜æ³•çš„æ€§èƒ½å¼‚å¸¸" title="Permanent link">&para;</a></h2>
<p>åœ¨ã€Šæ•°æ®ç»“æ„åŸºç¡€ã€‹è¯¾ç¨‹ Project 1 ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¯„ä¼°ä¸€æ®µè®¡ç®—å¹‚è¿ç®—ä»£ç çš„è¿è¡Œè€—æ—¶ï¼Œä»¥æ­¤åˆ†æå®ƒçš„æ—¶é—´å¤æ‚åº¦ã€‚å¹‚è¿ç®—çš„ç®—æ³•ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œä¸‹é¢æ˜¯ä¸€æ®µç¤ºä¾‹ä»£ç :</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kt">double</span><span class="w"> </span><span class="nf">pow</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">init_val</span><span class="p">,</span><span class="w"> </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">iteration</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">mx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_val</span><span class="p">;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">iteration</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">mx</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">init_val</span><span class="p">;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">mx</span><span class="p">;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">}</span>
</span></code></pre></div>
<p>ä»ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥æ¨å‡ºå…¶è¿è¡Œæ—¶é•¿åº”è¯¥åªä¸ iteration å˜é‡çº¿æ€§ç›¸å…³ï¼Œå¯¹åº”è¯¥ç®—æ³•å¤æ‚åº¦ä¸º <span class="arithmatex">\(O(N)\)</span>.</p>
<p>ç„¶è€Œä¸€éƒ¨åˆ†åŒå­¦åœ¨è¿›è¡Œå®éªŒæ—¶ï¼Œå‘ç°è¿™æ®µä»£ç çš„è¿è¡Œè€—æ—¶ä¸ä»…ä¸å¹‚æ¬¡æ–¹æœ‰å…³ï¼Œè¿˜ä¸åº•æ•° init_val æœ‰å…³ã€‚æ›´å…·ä½“è€Œè¨€ï¼Œå½“åº•æ•°æ¯”è¾ƒå¤§æ—¶ï¼Œæ€§èƒ½ä¼šå‘ç”Ÿéª¤é™ï¼Œæ¯”å¦‚è®¡ç®— <span class="arithmatex">\(1.5^n\)</span> ä¼šæ¯” <span class="arithmatex">\(1^n\)</span> æ…¢åå‡ å€ã€‚</p>
<p>åœ¨è®¨è®ºè¿‡ç¨‹ä¸­ï¼ŒåŒå­¦ä»¬åˆæ­¥æ¨æ–­å‡ºï¼Œç”±äºå¹‚å‡½æ•°å¢é•¿é€Ÿåº¦å¾ˆå¿«ï¼Œè®¡ç®—è¾ƒå¤§åº•æ•°æ—¶ï¼Œå¾ˆå¿«å°±ä¼šè¶…è¿‡ double ç±»å‹èƒ½è¡¨è¾¾çš„æ•°å­—ä¸Šé™ï¼Œæ­¤æ—¶ç»“æœå°†ä¼šå˜ä¸º infã€‚å› æ­¤é—®é¢˜çš„æœ¬è´¨ä¸åœ¨äºåº•æ•°çš„é€‰æ‹©ï¼Œè€Œåœ¨äºè¿ç®—è¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿäº†ä¸Šæº¢ (overflow) çš„é—®é¢˜ï¼Œå¦‚æœå‘ç”Ÿäº†ä¸Šæº¢ï¼Œé‚£ä¹ˆæ€§èƒ½å°±ä¼šéª¤é™ã€‚</p>
<!-- more -->

<p>è¿˜æœ‰çƒ­å¿ƒçš„åŒå­¦æä¾›äº†åœ¨ä¸åŒå¹³å°çš„æµ‹è¯•ï¼Œç¡®å®šäº†åœ¨ x86 æ¶æ„çš„ä¸¤å®¶å‚å•†ä¸­ï¼ŒIntel CPU å¹¿æ³›å­˜åœ¨è¯¥é—®é¢˜ï¼Œè€Œ AMD CPU ä¸å—å½±å“ã€‚åŒæ—¶ï¼Œé€šè¿‡æ”¹å˜ç¼–è¯‘å™¨ç‰ˆæœ¬ç¼–è¯‘åŒä¸€æ®µä»£ç ï¼Œå¯å‘ç°è¯¥é—®é¢˜å­˜åœ¨äºè€ç‰ˆæœ¬çš„ gcc ç¼–è¯‘å™¨ä¸­ã€‚åˆ†æå…¶äº§ç”Ÿçš„æ±‡ç¼–ä»£ç ï¼Œä¼šå‘ç°è€ç‰ˆæœ¬ gcc ç¼–è¯‘å™¨é»˜è®¤ä½¿ç”¨ x87 æµ®ç‚¹æ•°å•å…ƒï¼Œè€Œæ–°ç‰ˆæœ¬ç¼–è¯‘å™¨è‡³å°‘ä¼šå¯ç”¨ SSE è¿›è¡Œæµ®ç‚¹æ•°è¿ç®—ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬çš„é—®é¢˜å°±è¿›ä¸€æ­¥ç¼©çª„ä¸ºäº†: åœ¨ Intel CPU ä¸Šï¼Œä½¿ç”¨ x87 æµ®ç‚¹æ•°è¿ç®—å•å…ƒæ—¶ï¼Œå¯¹éè§„æ ¼æ•°å‚ä¸çš„æµ®ç‚¹æ•°è¿›è¡Œå¤„ç†æ—¶ï¼Œå‘ç”Ÿæ€§èƒ½éª¤é™çš„åŸå› ã€‚</p>
<p>åœ¨æ¢ç©¶é—®é¢˜ä¹‹å‰ï¼Œæœ‰å¿…è¦å¯¹ x87 æµ®ç‚¹è¿ç®—å•å…ƒè¿›è¡Œè¯¦ç»†çš„äº†è§£ä¸åˆ†æï¼Œä»¥ä¾¿æå‡ºåˆç†çŒœæƒ³å¹¶æ‰¾åˆ°éªŒè¯é€”å¾„:</p>
<h2 id="8087-ä¸-x87-æµ®ç‚¹è¿ç®—å•å…ƒ">8087 ä¸ x87 æµ®ç‚¹è¿ç®—å•å…ƒ<a class="headerlink" href="#8087-ä¸-x87-æµ®ç‚¹è¿ç®—å•å…ƒ" title="Permanent link">&para;</a></h2>
<p>åœ¨ 8086 æ—¶ä»£ï¼Œå®é™…ä¸Šå¤„ç†å™¨ç¡¬ä»¶æ˜¯ä¸å…·æœ‰æµ®ç‚¹æ•°å¤„ç†èƒ½åŠ›çš„ï¼Œæƒ³è¦è¿›è¡Œæµ®ç‚¹æ•°è¿ç®—ï¼Œä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨è½¯ä»¶æ¨¡æ‹Ÿï¼Œå¦å¤–ä¸€ç§æ–¹æ³•æ˜¯å¤–æŒ‚ä¸€ä¸ªæµ®ç‚¹æ•°åå¤„ç†å™¨ (co-processor). Intel 8086 å‘å¸ƒäº 1976 å¹´ï¼Œä½†å½“æ—¶ç›‘ç£ 8086 å¼€å‘çš„å·¥ç¨‹å¸ˆ Bill Pohlman åœ¨è®¾è®¡ä¹‹åˆå°±ç¡®ä¿ 8086 èƒ½å¤Ÿé€‚é…ä¸€æ¬¾å½“æ—¶ä»å¤„äºæ„æ€é˜¶æ®µçš„æµ®ç‚¹æ•°åå¤„ç†å™¨ã€‚</p>
<p>è¿™æ¬¾æµ®ç‚¹æ•°åå¤„ç†å™¨å°±æ˜¯ 8087, å‘å¸ƒäº 1980 å¹´ï¼Œä¹Ÿå°±æ˜¯ 8086 å‘å¸ƒå 4 å¹´ã€‚8087 æ˜¯ä¸–ç•Œä¸Šç¬¬ä¸€æ¬¾æµ®ç‚¹æ•°åå¤„ç†å™¨ï¼Œå®ç°äº†æµ®ç‚¹æ•°è¿ç®—çš„ç¡¬ä»¶æ”¯æŒã€‚å®ƒä¸ä»…å¯ä»¥å®Œæˆæµ®ç‚¹æ•°çš„åŸºæœ¬å››åˆ™è¿ç®—ï¼Œè¿˜å¯ä»¥å®Œæˆä¸‰è§’å‡½æ•°ã€å¯¹æ•°ã€ä¹˜æ–¹ç­‰ç­‰å¤šç§ä¸°å¯Œçš„è¿ç®—ï¼Œæå¤§åœ°æå‡äº†è®¡ç®—æœºçš„æµ®ç‚¹æ•°è¿ç®—èƒ½åŠ›ã€‚</p>
<p><a class="glightbox" href="../../../../assets/x87/8087.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="8087 èŠ¯ç‰‡çš„æ­£é¢ç…§ç‰‡, å›¾ä¸­çš„èŠ¯ç‰‡ä¸å°å†…å®¹ä¸º C8087 L6270114 i '80 '84" src="../../../../assets/x87/8087.png" /></a></p>
<p>8087 é€»è¾‘ä¸Šå¯ä»¥åˆ†æˆä¸¤å¤§éƒ¨åˆ†ï¼Œæ§åˆ¶å•å…ƒå’Œè¿ç®—å•å…ƒã€‚æ§åˆ¶å•å…ƒä¸ 8086 å¤„ç†å™¨ç›¸è¿ï¼Œå¹¶ç»´æŠ¤ä¸¤ä¸ªé‡è¦çš„å¤„ç†å™¨: Control Word ä¸ Status Word, å‰è€…æ§åˆ¶äº† 8087 çš„è¡Œä¸ºï¼Œæ¯”å¦‚æ˜¯å¦å¤„ç†å¼‚å¸¸ï¼Œæµ®ç‚¹æ•°çš„èˆå…¥æ¨¡å‹ç­‰ç­‰ï¼Œåè€…ç±»ä¼¼ flags å¯„å­˜å™¨ï¼Œè¡¨ç¤ºå½“å‰ 8087 å¤„ç†å™¨çš„çŠ¶æ€ã€‚è¿ç®—å•å…ƒçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªèƒ½å­˜å‚¨ 8 ä¸ª 80 ä½æµ®ç‚¹æ•°çš„å¯„å­˜å™¨æ ˆï¼Œå¯¹åº”åœ°ï¼Œå‘ 8087 å­˜å‚¨å’Œè¯»å–æµ®ç‚¹æ•°çš„æ“ä½œä¹Ÿå‡æ˜¯ä»¥æ ˆæ“ä½œçš„è¯­ä¹‰å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯å‹æ ˆ push å’Œå‡ºæ ˆ pop. 8087 å†…éƒ¨çš„ ROM ä¸Šå­˜å‚¨äº† <span class="arithmatex">\(\pi\)</span>, <span class="arithmatex">\(e\)</span>, <span class="arithmatex">\(\ln 2\)</span> ç­‰å¸¸æ•°ï¼Œé…åˆå¾®ç æ§åˆ¶çš„è¿ç®—ç”µè·¯ï¼Œå¯ä»¥å®ç°å„ç§å¤æ‚çš„æµ®ç‚¹æ•°æ“ä½œã€‚</p>
<p><a class="glightbox" href="../../../../assets/x87/image-1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="x87 å†…éƒ¨çš„ç»“æ„ï¼Œå›¾ä¸­å·¦ä¾§ä¸ºæ§åˆ¶å•å…ƒï¼Œå³ä¾§ä¸ºè¿ç®—å•å…ƒï¼Œè¿ç®—å•å…ƒå†…æœ‰ä¸€ä¸ªå®½åº¦ 80-bit, æ·±åº¦ 8 ä¸ªæµ®ç‚¹æ•°çš„æ ˆ" src="../../../../assets/x87/image-1.png" /></a></p>
<p>è¿™ç¯‡åšå®¢ä» die shot ä¸ç”µè·¯å±‚é¢ï¼Œè¯¦ç»†å‰–æäº† 8087 å¤„ç†å™¨å†…éƒ¨çš„å¯„å­˜å™¨ä»¥åŠè´Ÿè´£è¿ç®—çš„ç”µè·¯çš„ç»“æ„ï¼šhttps://www.righto.com/2018/08/inside-die-of-intels-8087-coprocessor.html . ï¼ˆå°½ç®¡ä¸ç°ä»£ x87 çš„ç¡¬ä»¶å®ç°å·²ç»å¤§ç›¸å¾„åº­ï¼Œä½†å“ªä¸ªç”·å­©ä¸å–œæ¬¢æ¬£èµç”µè·¯ä¹‹ç¾å‘¢ï¼‰</p>
<h2 id="8087-ä¸-8086-çš„åŒæ­¥">8087 ä¸ 8086 çš„åŒæ­¥<a class="headerlink" href="#8087-ä¸-8086-çš„åŒæ­¥" title="Permanent link">&para;</a></h2>
<p>æ—©æœŸ 8087 ä½œä¸ºä¸€æ¬¾åå¤„ç†å™¨ï¼Œéœ€è¦ä¸ 8086 å¤„ç†å™¨è¿›è¡Œæ²Ÿé€šæ‰èƒ½å®ç°æµ®ç‚¹æ•°è¿ç®—çš„åŠŸèƒ½ã€‚è¿™ä¸€æ–¹é¢æ˜¯æŒ‡ 8086 éœ€è¦å‘ 8087 å‘é€æ§åˆ¶ä¸æ•°æ®ä¿¡å·ï¼ŒæŒ‡å®š 8087 å®Œæˆå¯¹æŸä¸€æµ®ç‚¹æ•°çš„å…·ä½“æ“ä½œï¼Œæ­¤æ—¶ 8086 éœ€è¦ç­‰å¾… 8087 å®Œæˆè¿ç®—ï¼Œæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œã€‚å¦ä¸€æ–¹é¢ï¼Œ8087 åœ¨è¿ç®—æ—¶å¦‚æœäº§ç”Ÿå¼‚å¸¸ï¼Œä¹Ÿéœ€è¦ 8086 è¿›è¡Œåç»­çš„å¤„ç†ã€‚</p>
<p>åœ¨æŒ‡ä»¤ç¼–ç ä¸Šï¼Œ8087 ç›¸å…³çš„æŒ‡ä»¤éƒ½ä»¥ 0xdf-0xdf ä¹‹é—´çš„å‰ç¼€å¼€å§‹ï¼Œè¿™ä¸€å‰ç¼€ä»£è¡¨ Escape to co-processor, ä½¿ 8086 æ‰§è¡Œåˆ°ç›¸å…³æŒ‡ä»¤æ—¶ï¼Œ8087 èƒ½å¤Ÿè·å¾—æŒ‡ä»¤å¹¶è¿›è¡Œè§£ç ã€‚8087 çš„è¿ç®—ä¸ 8086 çš„æŒ‡ä»¤æ‰§è¡Œæ˜¯å¼‚æ­¥çš„ï¼Œå¦‚æœæƒ³è¦å¾—åˆ°æ­£ç¡®çš„ç»“æœï¼Œå°±éœ€è¦ç­‰å¾… 8087 å®Œæˆå¤„ç†å™¨ä¸åå¤„ç†å™¨ä¹‹é—´çš„åŒæ­¥ã€‚åŒæ­¥è¿‡ç¨‹åœ¨ Intel çš„è®¾è®¡ä¸‹æ˜¯æ˜¾å¼åœ°ï¼Œå¿…é¡»è°ƒç”¨ä¸€æ¡ fwait æŒ‡ä»¤æ¥å®Œæˆã€‚æ­¤æ—¶ 8086 ä¼šåœä¸‹è„šæ­¥ç­‰å¾… 8087 çš„æµ®ç‚¹è¿ç®—ï¼Œç„¶åæ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸äº§ç”Ÿï¼Œå†è¿›è¡Œåç»­çš„å¤„ç†ã€‚è¿™æ¡ fwait æŒ‡ä»¤ä¸éœ€è¦ç¨‹åºå‘˜è‡ªè¡Œæ·»åŠ ï¼Œå½“æ—¶çš„æ±‡ç¼–å™¨èƒ½å¤Ÿè‡ªåŠ¨åœ°åœ¨ 8087 æµ®ç‚¹æŒ‡ä»¤åæ’å…¥ fwait æ¥è¿›è¡ŒåŒæ­¥ã€‚https://stackoverflow.com/questions/42543905/what-are-8086-esc-instruction-opcodes</p>
<h2 id="ç°ä»£-x86-å¤„ç†å™¨ä¸-x87-ç›¸å…³çš„æ§åˆ¶ä½åŠå¼‚å¸¸">ç°ä»£ x86 å¤„ç†å™¨ä¸ x87 ç›¸å…³çš„æ§åˆ¶ä½åŠå¼‚å¸¸<a class="headerlink" href="#ç°ä»£-x86-å¤„ç†å™¨ä¸-x87-ç›¸å…³çš„æ§åˆ¶ä½åŠå¼‚å¸¸" title="Permanent link">&para;</a></h2>
<p>å°½ç®¡ç°åœ¨ x87 åå¤„ç†å™¨å·²ç»å˜æˆäº† x86 å¤„ç†å™¨å†…ç½®çš„æµ®ç‚¹å•å…ƒäº†ï¼Œåœ¨ Intel 64 å’Œ IA-32 å¤„ç†å™¨ä¸­ï¼Œä»ç„¶èƒ½å¤Ÿçœ‹åˆ°è¯¸å¤š x87 çš„èº«å½±:</p>
<ul>
<li>CR0 å¯„å­˜å™¨: åœ¨è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ åˆ° CR0 æ§åˆ¶äº† CPU çš„ä¿æŠ¤æ¨¡å¼å’Œå†…å­˜åˆ†é¡µæœºåˆ¶ï¼Œæ˜¯ CPU ä¸Šå°¤ä¸ºé‡è¦çš„ä¸€ä¸ªæ§åˆ¶å¯„å­˜å™¨ã€‚åœ¨å¦‚æ­¤é‡è¦çš„ CR0 ä¸­ï¼Œæœ‰å››ä½æ˜¯ä¸ x87 å¤„ç†å™¨ç›´æ¥ç›¸å…³çš„:
  <a class="glightbox" href="../../../../assets/x87/image-2.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="CR0 å„ä½ä½œç”¨çš„è¯´æ˜å›¾" src="../../../../assets/x87/image-2.png" /></a> - ET (Extension type): ç”¨äºåŒºåˆ† x87 åå¤„ç†å™¨çš„ç§ç±»ï¼Œè‹¥ä¸º 1 åˆ™ä¸º Intel 387 DX åŠä¹‹åï¼Œä¸º 0 åˆ™ä»£è¡¨ Intel 287 åŠä¹‹å‰çš„ x87 åå¤„ç†å™¨ã€‚åœ¨ç°ä»£ CPU ä¸Šè¿™ä¸€ä½æ’ä¸º 1. - MP (Monitor Co-processor): ç”¨äºæ§åˆ¶ wait/fwait æŒ‡ä»¤æ˜¯å¦äº§ç”Ÿ #NM (Device not available) å¼‚å¸¸ï¼Œç°ä»£å¤„ç†å™¨ä¸éœ€è¦è¯¥æœºåˆ¶ï¼Œä¸”æ¨èè®¾ç½®æ’ä¸º 1. - EM (x87 FPU Emulation): ç”¨äºæ§åˆ¶æ˜¯å¦å¼€å¯æ¨¡æ‹Ÿ x87 çš„è½¯ä»¶æµ®ç‚¹è¿ç®—ï¼Œå¦‚æœ EM ç½®ä¸º 1ï¼Œé‚£ä¹ˆä»»ä½• x87 æŒ‡ä»¤å°†ä¼šå¯¼è‡´ #NM å¼‚å¸¸ï¼Œç¨‹åºå‘˜éœ€è¦åœ¨å¼‚å¸¸å¤„ç†ä¸­è¿›è¡Œè½¯ä»¶æµ®ç‚¹æ•°æ¨¡æ‹Ÿã€‚åŒæ—¶å°†ä¼šç¦æ­¢å…¶ä»–æµ®ç‚¹æŒ‡ä»¤ï¼Œå¦‚ MMX, SSE æ‰©å±•ç­‰ç­‰ï¼Œå¦åˆ™ä¼šäº§ç”Ÿ #UD å¼‚å¸¸ã€‚
  <a class="glightbox" href="../../../../assets/x87/image-3.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="CR0 å¯„å­˜å™¨ EM, MP, TS çš„æ‰€æœ‰æƒ…å†µä¸‹ï¼Œå¯¹ x87 æŒ‡ä»¤çš„å¤„ç†æ–¹æ³•" src="../../../../assets/x87/image-3.png" /></a> - NE (Numeric Exception): ç”¨äºæ§åˆ¶ x87 å¼‚å¸¸çš„å¤„ç†æ–¹å¼ï¼Œè‹¥ä¸º 1ï¼Œåˆ™ç”± CPU å†…éƒ¨é€šè¿‡ #MF å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œå¦åˆ™å°†é€šè¿‡å¤–éƒ¨ç¡¬ä»¶çš„ä¸­æ–­è¯·æ±‚çº¿åŒå¿—å¤–éƒ¨è®¾å¤‡ï¼Œå€ŸåŠ©å¤–éƒ¨ç¡¬ä»¶çš„é€»è¾‘æ¥å¤„ç†è¯¥å¼‚å¸¸ã€‚</li>
</ul>
<blockquote>
<p>The NE (Numeric Exception) flag (bit 5 of the CR0 register) is used in the P6 family, Pentium, and Intel486 processors to determine whether unmasked floating-point exceptions are reported internally through interrupt vector 16 (flag is set) or externally through an external interrupt (flag is clear). On a hardware reset, the NE flag is initialized to 0, so software using the automatic internal error-reporting mechanism must set this flag to 1. This flag is nonexistent on the Intel386 processor.
<a class="glightbox" href="../../../../assets/x87/image-4.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Intel 64 å’Œ IA-32 æ¶æ„çš„é€šç”¨å¼‚å¸¸è¡¨" src="../../../../assets/x87/image-4.png" /></a></p>
</blockquote>
<ul>
<li>x87 æ§åˆ¶å¯„å­˜å™¨ ï¼ˆControl Wordï¼‰</li>
<li>RC ä¸ PC æ§åˆ¶ x87 çš„èˆå…¥ä¸ç²¾åº¦</li>
<li>ä½ 6 ä½ä¸º Exception Maskï¼Œå¦‚æœç½® 1ï¼Œè¯¥ç±»å¼‚å¸¸ä¸ä¼šè¢«è§¦å‘
    <a class="glightbox" href="../../../../assets/x87/image-5.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="x87 æ§åˆ¶å¯„å­˜å™¨çš„å„ä½åŠŸèƒ½è¯´æ˜" src="../../../../assets/x87/image-5.png" /></a></li>
</ul>
<h2 id="ieee-754-æ ‡å‡†">IEEE 754 æ ‡å‡†<a class="headerlink" href="#ieee-754-æ ‡å‡†" title="Permanent link">&para;</a></h2>
<p>IEEE 754 æ ‡å‡†æ˜¯ç›®å‰å¹¿æ³›æ¥å—ä¸ä½¿ç”¨çš„æµ®ç‚¹æ•°è¿ç®—æ ‡å‡†ï¼Œå®ƒå®šä¹‰äº†æµ®ç‚¹æ•°çš„æ ¼å¼å’Œæ“ä½œï¼Œç¡®ä¿äº†ä¸åŒè®¡ç®—æœºç³»ç»Ÿé—´æµ®ç‚¹è¿ç®—ç»“æœçš„ä¸€è‡´æ€§ã€‚ä»å†å²è§’åº¦æ¥çœ‹ï¼ŒIEEE 754 æ ‡å‡†æ”¶åˆ°äº† 8087 åå¤„ç†å™¨çš„æ˜¾è‘—å½±å“ï¼Œå› ä¸º Intel 8087 æ˜¯å†å²ä¸Šç¬¬ä¸€æ¬¾ç¡¬ä»¶æµ®ç‚¹åå¤„ç†å™¨ï¼Œå¼•å…¥äº†æµ®ç‚¹æ•°çš„åŸºæœ¬æ¦‚å¿µã€è¿ç®—æ“ä½œå’Œä¸€äº›ç‰¹å®šçš„å¼‚å¸¸å¤„ç†æ–¹æ³•ã€‚IEEE 754 æ ‡å‡†çš„è®¸å¤šæ ¸å¿ƒæ¦‚å¿µï¼Œæ¯”å¦‚èˆå…¥æ¨¡å¼å’Œå¼‚å¸¸çš„å®šä¹‰ï¼Œéƒ½åœ¨ 8087 ä¸­æœ‰æ‰€ä½“ç°ã€‚å¯ä»¥è¯´ 8087 ä¸º IEEE 754 æ ‡å‡†çš„è¯ç”Ÿå¥ å®šäº†åŸºç¡€ï¼Œè€Œ IEEE 754 æ ‡å‡†åœ¨åæ¥çš„å¤„ç†å™¨è®¾è®¡ä¸­è¿›ä¸€æ­¥æ¨å¹¿å¹¶å®Œå–„äº†è¿™äº›ç†å¿µï¼Œåæ¥ IEEE 754 åˆåå‘å½±å“äº† 80387 åŠä»¥å Intel çš„æµ®ç‚¹æ•°å¤„ç†å•å…ƒçš„è§„èŒƒåŒ–è®¾è®¡ã€‚</p>
<h3 id="æ‰©å±•ç²¾åº¦æ ¼å¼">æ‰©å±•ç²¾åº¦æ ¼å¼<a class="headerlink" href="#æ‰©å±•ç²¾åº¦æ ¼å¼" title="Permanent link">&para;</a></h3>
<p>åœ¨ x87 FPU ä¸­ï¼Œæµ®ç‚¹æ•°ä½æ•°å‡ä¸º 80 ä½ï¼Œè¿™ä¸€æ ¼å¼åœ¨ IEEE 754 ä¸­è¢«è§„èŒƒåŒ–ä¸ºæ‰©å±•ç²¾åº¦æ ¼å¼ï¼Œå®ƒåŒ…æ‹¬ 1 ä½ç¬¦å·ä½ï¼Œ15 ä½æŒ‡æ•°ä½ï¼Œä»¥åŠ 64 ä½å°¾æ•°ã€‚å…¶è§„å®šçš„æ— ç©·å¤§ä»¥åŠ NaN æ•°å€¼å¦‚ä¸‹è¡¨æ‰€ç¤º:
<a class="glightbox" href="../../../../assets/x87/image-6.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="IEEE 754 å„ç±»æµ®ç‚¹æ•°çš„ç¼–ç è§„åˆ™" src="../../../../assets/x87/image-6.png" /></a></p>
<h3 id="éæ­£è§„æ•°çš„è¿ç®—">éæ­£è§„æ•°çš„è¿ç®—<a class="headerlink" href="#éæ­£è§„æ•°çš„è¿ç®—" title="Permanent link">&para;</a></h3>
<p>Intel æµ®ç‚¹æ•°å‚è€ƒæ‰‹å†Œ è¯¦ç»†ä»‹ç»äº† SSE å’Œ AVX æŒ‡ä»¤å¯¹ normal / subnormal / denormal æ•°å­—ä»¥åŠä»–ä»¬ä¹‹é—´è¿›è¡Œè¿ç®—æ—¶äº§ç”Ÿçš„ç»“æœä»¥åŠå¼‚å¸¸ä½è®¾ç½®ã€‚é™¤äº†å¼‚å¸¸ç§ç±»ä¸åŒï¼Œä»¥åŠ x87 æ²¡æœ‰ DAZ (Denormal as zero) ä»¥åŠ FTZ (Flush to zero) è®¾ç½®ä¹‹å¤–ï¼Œå…¶ç»“æœåº”è¯¥æ˜¯ç›¸åŒçš„:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-7.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Intel SSE å’Œ AVX æ‰©å±•å¯¹ IEEE 754 éè§„æ ¼æ•°å‚ä¸çš„è¿ç®—ç»“æœçš„çº¦å®š" src="../../../../assets/x87/image-7.png" /></a></p>
<h1 id="æ¢ç©¶è¿‡ç¨‹">æ¢ç©¶è¿‡ç¨‹<a class="headerlink" href="#æ¢ç©¶è¿‡ç¨‹" title="Permanent link">&para;</a></h1>
<h2 id="çŒœæƒ³-1-ä¸-x87-å¼‚å¸¸äº§ç”Ÿçš„ä¸­æ–­å’Œæ“ä½œç³»ç»Ÿå¤„ç†æœ‰å…³">çŒœæƒ³ 1: ä¸ x87 å¼‚å¸¸äº§ç”Ÿçš„ä¸­æ–­å’Œæ“ä½œç³»ç»Ÿå¤„ç†æœ‰å…³<a class="headerlink" href="#çŒœæƒ³-1-ä¸-x87-å¼‚å¸¸äº§ç”Ÿçš„ä¸­æ–­å’Œæ“ä½œç³»ç»Ÿå¤„ç†æœ‰å…³" title="Permanent link">&para;</a></h2>
<h3 id="åˆ†æ">åˆ†æ<a class="headerlink" href="#åˆ†æ" title="Permanent link">&para;</a></h3>
<p>åœ¨å¯¹ x87 è¿›è¡Œè¯¦ç»†ä»‹ç»çš„æ—¶å€™ï¼Œæˆ‘ä»¬æåˆ° CPU æœ‰å¤šç§å¼‚å¸¸ä¸ x87 æœ‰å…³: ä¸€æ–¹é¢ï¼Œx87 æœ¬èº«ä¼šäº§ç”Ÿ P, U, O, Z, D, I è¿™ 6 ç§å¼‚å¸¸ï¼Œå¦ä¸€æ–¹é¢ï¼Œåœ¨ x87 è¿ç®—çš„è¿‡ç¨‹ä¸­ï¼Œè¿˜æœ‰å¯èƒ½è§¦å‘é€šç”¨å¼‚å¸¸ #NM, #MF ç­‰ç­‰ã€‚æˆ‘ä»¬çŸ¥é“ä¸€æ—¦å‘ç”Ÿå¼‚å¸¸ï¼Œå°±ä¼šå¯¼è‡´ CPU éœ€è¦è·³è½¬åˆ°æ“ä½œç³»ç»ŸæŒ‡å®šçš„ä»£ç è¿›è¡Œå¤„ç†ï¼Œæ‰“æ–­åŸå…ˆç¨‹åºçš„æ‰§è¡Œï¼Œä¸¥é‡å½±å“æ€§èƒ½ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥åˆ†æ x87 æœ¬èº«çš„å¼‚å¸¸ã€‚åœ¨ x87 FPU çš„æ§åˆ¶å¯„å­˜å™¨ fpcw ä¸­ï¼Œå­˜å‚¨ç€å¼‚å¸¸çš„æ©ç  (mask)ï¼Œä¸€æ—¦å¯¹åº”ä½ç½® 1ï¼Œ å°±ä»£è¡¨è¿™ä¸€ç±»å¼‚å¸¸è¢«æ©ç›–ä½ï¼Œä¸ä¼šæŠ¥å‘Šç»™æ“ä½œç³»ç»Ÿã€‚</p>
<p>é€šè¿‡ fnstcw æŒ‡ä»¤å¯ä»¥è·å– fpcw å¯„å­˜å™¨çš„å€¼ã€‚åœ¨ä¸åšä»»ä½•æ“ä½œçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥çœ‹åˆ° fpcw çš„é»˜è®¤å€¼ä¸º 0x037F, ä¹Ÿå°±æ˜¯è¯´é»˜è®¤æ‰€æœ‰çš„å¼‚å¸¸éƒ½è¢«æ©ç›–ä½äº†ã€‚</p>
<p><a class="glightbox" href="../../../../assets/x87/image-8.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-8.png" /></a></p>
<p>å¦‚æœæ‰‹åŠ¨è®¾ç½® fpcwï¼Œå°†å¯¹åº”çš„ mask ä½è§£é™¤ï¼Œåœ¨ç¨‹åºæ²¡æœ‰å£°æ˜è‡ªå·±çš„æµ®ç‚¹å¼‚å¸¸å¤„ç†å‡½æ•°æ—¶ï¼Œä¼šä¸ŠæŠ¥ç»™æ“ä½œç³»ç»Ÿäº§ç”Ÿ floating point exception, å¹¶ç»“æŸç¨‹åºè¿è¡Œã€‚è¿™ä¸æˆ‘ä»¬é—®é¢˜èƒŒæ™¯é‡Œçš„æƒ…å†µä¸å¤ªç›¸åŒï¼Œè¯´æ˜åŸé—®é¢˜å¹¶ä¸æ˜¯å› ä¸º x87 æœ¬èº«çš„å¼‚å¸¸å¯¼è‡´çš„ã€‚</p>
<p><a class="glightbox" href="../../../../assets/x87/image-9.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-9.png" /></a></p>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥åˆ†æä¸€ä¸‹æ˜¯å¦äº§ç”Ÿäº† CPU çš„é€šç”¨å¼‚å¸¸ã€‚cr0 æ˜¯è®¾ç½®ä¸ x87 ç›¸å…³å¼‚å¸¸çš„å…³é”®å¯„å­˜å™¨ï¼Œä½†é€šè¿‡åˆ†æï¼Œåœ¨ç°ä»£çš„ CPU ä¸Šï¼Œæˆ‘ä»¬å®é™…å¯ä»¥è®¾ç½®çš„åªæœ‰ cr0.ne è¿™ä½å¯èƒ½ä¼šæœ‰æ•ˆæœã€‚è¿™ä¸ªå¯„å­˜å™¨éœ€è¦ Ring 0 çº§åˆ«çš„æƒé™æ‰å¯ä»¥è¿è¡Œï¼Œæ‰€ä»¥æˆ‘å†™äº†ä¸€ä¸ª Linux å†…æ ¸æ¨¡å—:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">__init</span><span class="w"> </span><span class="nf">cr0_ne_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">cr0</span><span class="p">;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="n">cr0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_cr0</span><span class="p">();</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;Original CR0: 0x%lx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cr0</span><span class="p">);</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;Original CR0.NE: %lu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">cr0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x1</span><span class="p">);</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="c1">// æ¸…é™¤ CR0.NE ä½ï¼ˆç¬¬5ä½ï¼‰</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">    </span><span class="n">cr0</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="p">(</span><span class="mi">1UL</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">    </span><span class="n">write_cr0</span><span class="p">(</span><span class="n">cr0</span><span class="p">);</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">    </span><span class="n">cr0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_cr0</span><span class="p">();</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">    </span><span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;Modified CR0: 0x%lx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cr0</span><span class="p">);</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">    </span><span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;Modified CR0.NE: %lu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">cr0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x1</span><span class="p">);</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="p">}</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__exit</span><span class="w"> </span><span class="nf">cr0_ne_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">cr0</span><span class="p">;</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="w">    </span><span class="c1">// æ¢å¤ CR0.NE ä½ï¼ˆè®¾ç½®ç¬¬5ä½ï¼‰</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="w">    </span><span class="n">cr0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_cr0</span><span class="p">();</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="w">    </span><span class="n">cr0</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="p">(</span><span class="mi">1UL</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="w">    </span><span class="n">write_cr0</span><span class="p">(</span><span class="n">cr0</span><span class="p">);</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="w">    </span><span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;CR0.NE restored.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="p">}</span>
</span></code></pre></div>
<p>æˆ‘åœ¨æˆ‘çš„ç¬”è®°æœ¬ä¸Šå®‰è£…äº†åŸç”Ÿçš„ Linux ç¯å¢ƒï¼ŒåŠ è½½è¯¥å†…æ ¸æ¨¡å—åï¼Œå¯ä»¥åœ¨å†…æ ¸æ¶ˆæ¯ dmesg ä¸­çœ‹åˆ°å¯„å­˜å™¨æˆåŠŸè¢«ä¿®æ”¹ï¼Œä½†æ˜¯è¿è¡Œå…ˆå‰çš„æµ‹è¯•ï¼Œä¾æ—§å¯ä»¥è§‚æµ‹åˆ°æ€§èƒ½éª¤é™çš„é—®é¢˜ã€‚è¿™è¯´æ˜å®é™…ä¸Šè¿™ä¸ªé—®é¢˜ä¸ cr0.ne æ²¡æœ‰å…³è”ã€‚</p>
<h3 id="å®éªŒ">å®éªŒ<a class="headerlink" href="#å®éªŒ" title="Permanent link">&para;</a></h3>
<p>é™¤äº†åœ¨åˆ†æéƒ¨åˆ†ä½“ç°çš„å°å®éªŒå¤–ï¼Œæˆ‘è¿˜å°è¯•åœ¨å„ç§å¹³å°ã€å„ç§æ“ä½œç³»ç»Ÿä¸Šå¹¿æ³›åœ°å°è¯•ã€‚
æˆ‘çš„æµ‹è¯•å¹³å°ä¸º Intel Core i7-12700H, Intel Celeron 3865U, ä»¥åŠ Intel Xeon Gold 5320ã€‚Intel Core i7-12700 H ä¸º 12 ä»£ç¬”è®°æœ¬ CPUï¼Œå¾®æ¶æ„ä¸º 2021 å¹´å‘å¸ƒçš„ Alder Lake; Celeron 3865U æ¥è‡ªæˆ‘çš„ä¸€å—å·¥æ§æ¿ï¼ˆå…¶å‘½åæ˜¯è‡´æ•¬ 80386 çš„ï¼‰ï¼Œå±äºä½ç«¯åµŒå…¥å¼äº§å“çº¿ï¼Œå¾®æ¶æ„ä¸º 2016 å¹´å‘å¸ƒçš„ Kaby Lake; Xeon 5320 ä¸º Inel ç¬¬ä¸‰ä»£å¿—å¼ºæœåŠ¡å™¨å¤„ç†å™¨ï¼Œå¾®æ¶æ„ä¸º 2019 å¹´çš„ Ice Lakeã€‚è¿™ä¸‰æ¬¾ CPU è¦†ç›–äº†è‹±ç‰¹å°”çš„ Coreã€Celeronã€Xeon å¤šä¸ªäº§å“çº¿ï¼Œè¦†ç›–äº†è·¨åº¦è¾ƒé•¿çš„å¾®æ¶æ„è®¾è®¡ï¼Œåº”å½“å…·æœ‰è¶³å¤Ÿçš„æ™®éæ€§ã€‚</p>
<p>æµ‹è¯•ç”¨åˆ°çš„ä»£ç é™„åœ¨ä½œä¸šæäº¤çš„æ–‡ä»¶ä¸­ï¼Œä»£ç å¯ä»¥è‡ªåŠ¨å¯¹æ¯” x87 ä¸ SSEã€AVX åœ¨ä¸åŒè¾“å…¥ï¼ˆæ­£è´Ÿ INFï¼Œ NaNï¼Œä¸‹æº¢ç­‰ï¼‰ã€ä¸åŒæ“ä½œï¼ˆä¹˜æ³•ã€åŠ æ³•ï¼‰ä¹‹ä¸‹çš„æ€§èƒ½è¡¨ç°ã€‚</p>
<p>é¦–å…ˆæ˜¯ Windows å¹³å°ï¼Œæµ‹é‡äº Intel i7-12700H:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-10.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-10.png" /></a></p>
<p>å…¶æ¬¡æ˜¯ Linux å¹³å°ï¼Œæµ‹é‡äº Intel Xeon 5320:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-11.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-11.png" /></a></p>
<p>åœ¨ä¸¤ä¸ªå¹³å°ä¸Šï¼Œå¯ä»¥è§‚å¯Ÿåˆ° x87 å¯¹äº INF å’Œ NaN å‚ä¸çš„è¿ç®—ï¼Œæ€§èƒ½æ˜¾è‘—ä½äº SSE ä¸ AVXï¼Œè€Œä¸‹æº¢å‡º (underflow) çš„æ—¶é—´åˆ™ç›¸è¿‘ã€‚</p>
<p>æœ€åæˆ‘è¿˜ä¸º Celeron 3865U å¹³å°å®‰è£…äº† FreeDOSï¼Œä¸€æ¬¾å¼€æºçš„ä»¿ MS-DOS ç³»ç»Ÿï¼Œå®ƒæ”¯æŒåœ¨ç°ä»£çš„å¹³å°ä¸Šç»§ç»­è¿è¡Œ DOS ç³»ç»Ÿã€‚FreeDOS ç›¸è¾ƒäºå…¶ä»–ä¸¤æ¬¾æ“ä½œç³»ç»Ÿï¼Œç”±äºå¯ä»¥ç›´æ¥è·‘åœ¨å®æ¨¡å¼ä¸‹ï¼Œä¸”ç¨‹åºè¿è¡Œæ—¶å…·æœ‰å®Œå…¨çš„æƒé™ï¼Œèƒ½å¤Ÿæ’é™¤å¾ˆå¤šè½¯ä»¶å±‚é¢çš„å½±å“ã€‚åœ¨ FreeDOS ç³»ç»Ÿä¸‹ï¼Œæˆ‘é€‰æ‹©äº† bcc ç¼–è¯‘å™¨å’Œæ‰‹å†™ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç¨‹åºï¼Œå› ä¸ºç¼–è¯‘å™¨å’Œæ„å»ºç³»ç»Ÿå®Œå…¨ä¸åŒï¼Œåªæµ‹è¯•äº† mul_norm å’Œ mul_pinf ä¸¤ç§æƒ…å†µã€‚åœ¨ FreeDOS ç³»ç»Ÿä¸­ï¼Œå¯ä»¥è§‚æµ‹åˆ° mul_pinf çš„é€Ÿåº¦æ˜¾è‘—ä½äº mul_normï¼Œä¹Ÿå¯ä»¥è¿›ä¸€æ­¥å¼•è¯æ€§èƒ½å¼‚å¸¸ä¸æ“ä½œç³»ç»Ÿå’Œè½¯ä»¶åŸºæœ¬æ— å…³ï¼Œå±äºç¡¬ä»¶æœºåˆ¶ã€‚</p>
<h2 id="çŒœæƒ³-2-ä¸-cpu-å¯¹-x87-å¼‚å¸¸çš„å¤„ç†çš„å¾®ç è¾…åŠ©æœ‰å…³">çŒœæƒ³ 2: ä¸ CPU å¯¹ x87 å¼‚å¸¸çš„å¤„ç†çš„å¾®ç è¾…åŠ©æœ‰å…³<a class="headerlink" href="#çŒœæƒ³-2-ä¸-cpu-å¯¹-x87-å¼‚å¸¸çš„å¤„ç†çš„å¾®ç è¾…åŠ©æœ‰å…³" title="Permanent link">&para;</a></h2>
<h3 id="åˆ†æ_1">åˆ†æ<a class="headerlink" href="#åˆ†æ_1" title="Permanent link">&para;</a></h3>
<p>perf æ˜¯ Linux ä¸Šçš„ä¸€æ¬¾æ€§èƒ½åˆ†æå·¥å…·ï¼Œå®ƒå¯ä»¥è¯»å– Intel æä¾›çš„æ€§èƒ½è®¡æ•°å™¨ (PMU, Performance Monitoring Units) è·å–å½±å“ CPU æ€§èƒ½å› ç´ çš„ä¸€æ‰‹æ•°æ®ã€‚perf å¯ä»¥æµ‹é‡çš„æŒ‡æ ‡åŒ…æ‹¬ CPU å‘å°„çš„æŒ‡ä»¤æ•°é‡ï¼Œç¨‹åºè¿è¡Œçš„æ€»å‘¨æœŸæ•°ç­‰ç­‰ï¼Œè¿›è€Œå¯ä»¥è®¡ç®— CPI ç­‰æŒ‡æ ‡è¡¡é‡ CPU çš„æ€§èƒ½é‡Šæ”¾æƒ…å†µã€‚</p>
<p>åœ¨ perf æ”¯æŒçš„è§‚æµ‹æŒ‡æ ‡ä¸­ï¼Œæœ‰ä¸€ç³»åˆ—ä¸æµ®ç‚¹æ•°ç›¸å…³çš„æŒ‡æ ‡ï¼Œè¿™å¸å¼•äº†æˆ‘çš„å…´è¶£:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>$<span class="w"> </span>perf<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>less
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>...
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>floating<span class="w"> </span>point:
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span>arith.fpdiv_active
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">       </span><span class="o">[</span>ARITH.FPDIV_ACTIVE<span class="o">]</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">  </span>assists.fp
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">       </span><span class="o">[</span>Counts<span class="w"> </span>all<span class="w"> </span>microcode<span class="w"> </span>FP<span class="w"> </span>assists<span class="o">]</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">  </span>assists.sse_avx_mix
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">       </span><span class="o">[</span>ASSISTS.SSE_AVX_MIX<span class="o">]</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">  </span>fp_arith_dispatched.port_0
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">       </span><span class="o">[</span>FP_ARITH_DISPATCHED.PORT_0<span class="o">]</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">  </span>fp_arith_dispatched.port_1
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">       </span><span class="o">[</span>FP_ARITH_DISPATCHED.PORT_1<span class="o">]</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">  </span>fp_arith_dispatched.port_5
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="w">       </span><span class="o">[</span>FP_ARITH_DISPATCHED.PORT_5<span class="o">]</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="w"> </span>...
</span></code></pre></div>
<p>æˆ‘æŒ‘é€‰äº†æ‰€æœ‰å¯èƒ½ä¸ x87 ç›¸å…³çš„æŒ‡æ ‡è¿›è¡Œäº†æµ‹è¯•ï¼Œå¹¶è§‚å¯Ÿä»–ä»¬çš„æ€§èƒ½æŒ‡æ ‡ï¼ŒæœçœŸå‘ç°äº†ç«¯å€ª: å…¶ä¸­ assists.fp è¿™ä¸ªæŒ‡æ ‡äºŒè€…å·®å¼‚å¾ˆå¤§ï¼Œè€Œä¸”åœ¨å¼‚å¸¸æ—¶ï¼Œæ•°é‡æå…¶æ¥è¿‘æˆ‘è®¾ç½®çš„è¿­ä»£æ¬¡æ•°:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-13.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-13.png" /></a></p>
<p>è¯´æ˜è¿™ä¸ªæŒ‡æ ‡æ˜¯æˆ‘ä»¬æ¢ç©¶é—®é¢˜çœŸç›¸çš„å…³é”®! é¦–å…ˆçœ‹å®ƒçš„ä»‹ç»:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="w">   </span>assists.fp
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">       </span><span class="o">[</span>Counts<span class="w"> </span>all<span class="w"> </span>microcode<span class="w"> </span>FP<span class="w"> </span>assists<span class="o">]</span>
</span></code></pre></div>
<p>ä¹Ÿå°±æ˜¯ç»Ÿè®¡äº†åœ¨æµ®ç‚¹æ•°è¿ç®—æ—¶å¾®ç è¾…åŠ©çš„æ¬¡æ•°ã€‚å¾®ç è¾…åŠ©æ˜¯ Intel CPU çš„ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥ç»“åˆä¸‹å›¾æ¥ç†è§£:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-12.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-12.png" /></a></p>
<p>è¿™æ˜¯ä¸€å¼  Intel CPU å¾®æ¶æ„çš„ç¤ºæ„å›¾ï¼Œå…¶ä¸­ç»¿è‰²çš„æ˜¯æˆ‘ä»¬å¯è§çš„ x86 æŒ‡ä»¤ï¼Œè€Œåœ¨ Intel CPU è¿è¡Œçš„æ—¶å€™ï¼Œè¿™äº› CISC æŒ‡ä»¤éƒ½ä¼šè¢«è½¬æ¢ä¸ºç±»ä¼¼ RISC çš„æŒ‡ä»¤â€”â€”å¾®ç  (microcode)ã€‚åœ¨ Intel CPU ä¸­ï¼Œæœ‰ä¸€ä¸ªå•å…ƒå«åš Microcode Sequencerï¼Œç”¨æ¥ä» MS ROM ä¸­è¯»å–å¾®ç å¹¶æ‰§è¡Œã€‚å¾®ç è¾…åŠ©å‘ç”Ÿåœ¨ CPU å†…éƒ¨å‡ºç°å¼‚å¸¸å¹¶ä¸”æ²¡æœ‰èƒ½å¤Ÿå¤„ç†çš„ç¡¬ä»¶å•å…ƒæ—¶ï¼Œæ­¤æ—¶å‰ç«¯çš„æŒ‡ä»¤è§£ç å’Œåç«¯çš„ä¹±åºæ‰§è¡Œéƒ½ä¼šè¢«æ‰“æ–­ (Machine Clear)ï¼Œè½¬è€Œå¯åŠ¨ Microcode Sequencer è°ƒå‡ºå¤„ç†å¯¹åº”æƒ…å†µçš„å¾®ç å¹¶æ‰§è¡Œã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªéå¸¸å½±å“æ€§èƒ½çš„æ“ä½œ â€”â€” Machine Clearï¼Œå¦‚æœè¿›ä¸€æ­¥ç¿»é˜…è‹±ç‰¹å°”æ‰‹å†Œ IntelÂ® 64 and IA-32 Architectures Optimization Reference Manual å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æè¿°:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-14.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-14.png" /></a></p>
<p>è¿™å®Œå…¨ç¬¦åˆæˆ‘ä»¬æ‰€é‡åˆ°çš„æƒ…å†µï¼Œåªä¸è¿‡æˆ‘ä»¬çš„æƒ…å†µæ˜¯ subnormal è€Œé denormal æ•°ï¼Œä¸è¿‡éƒ½éœ€è¦å¾®ç æ¥è¾…åŠ©å¤„ç†ç»“æœã€‚è¿›ä¸€æ­¥ç”¨ perf æŸ¥çœ‹ machine clear çš„æƒ…å†µï¼Œå¯ä»¥å‘ç°å®ƒçš„æ¬¡æ•°å’Œå¼‚å¸¸å‡ºç°æ¬¡æ•°ã€è¿­ä»£æ¬¡æ•°åŸºæœ¬ä¸€è‡´ï¼Œå¹¶ä¸”è¿œè¿œè¶…è¿‡æ— æµ®ç‚¹å¼‚å¸¸çš„æƒ…å†µã€‚</p>
<p><a class="glightbox" href="../../../../assets/x87/image-15.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-15.png" /></a></p>
<p>æ¥ç€è¿™ä¸ªåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å›ç­”è¿™ä¸‰ä¸ªé—®é¢˜äº†:</p>
<ol>
<li>ä¸ºä»€ä¹ˆ x87 çš„æŒ‡ä»¤åœ¨å¼‚å¸¸æ—¶ä¼šå¦‚æ­¤ä¹‹æ…¢ï¼Ÿ</li>
</ol>
<blockquote>
<p>Some instructions (FSIN, FCOS, and other transcendental instructions) are decoded with the assistance of MS-ROM. Frequent occurrences of instructions that required assistance of MS-ROM to decode complex uop flows are opportunity to improve instruction selection to reduce such occurrences. The UOPS_DECODED.MS event can be used to identify code regions that could benefit from better instruction selection. Other situations that can trigger this event are due to FP assists, like performing a numeric operation on denormalized FP values or QNaNs. In such cases the penalty is essentially the uops required for the assist plus the pipeline clearing required to ensure the correct state. Consequently this situation has a very clear signature consisting of MACHINE_CLEAR.CYCLES and uops being inserted by the microcode sequencer, UOPS_DECODED.MS. The execution penalty being the sum of these two contributions. The event codes for these are listed under D1H and C3H. â€”â€” IntelÂ® 64 and IA-32 Architectures Optimization Reference Manual</p>
</blockquote>
<p>è‹±ç‰¹å°”å¯¹äºç°ä»£ CPU ä¸Šçš„ x87 FPU çš„å®ç°ä¾ç„¶æ¯”è¾ƒâ€œåŸå§‹â€ï¼Œä½†å‡¡æ¶‰åŠåˆ°è¾ƒå¤æ‚çš„å¤„ç†ï¼Œèƒ½ä¸æ–°è®¾è®¡ç¡¬ä»¶å°±ä¸æ–°è®¾è®¡ç¡¬ä»¶ï¼Œæ‰€ä»¥æ¯”è¾ƒå¤æ‚çš„ä¸‰è§’å‡½æ•° (fsin, fcos), ä»¥åŠåƒ denormal / subnormal æ•°çš„å¤„ç†ï¼Œç»Ÿç»Ÿä½¿ç”¨å¾®ç æ¥å®ç°ã€‚è¿™å°±å¯¼è‡´åœ¨ä½¿ç”¨ x87 FPU çš„æ—¶å€™ï¼Œç¨ä¸æ³¨æ„å°±æœ‰å¯èƒ½é‡åˆ°å¼‚å¸¸æƒ…å†µï¼Œå¿…é¡»è¦é€šè¿‡ Machine Clear æ‰“æ–­æµæ°´çº¿ï¼Œä»å¾®ç  ROM ä¸­è°ƒå‡ºå¤„ç†çš„å¾®ç ï¼Œæå¤§å½±å“äº†ç°ä»£ CPU æŒ‡ä»¤çº§å¹¶è¡Œçš„æ€§èƒ½ã€‚</p>
<ol>
<li>ä¸ºä»€ä¹ˆ SSEï¼ŒAVX ç­‰æµ®ç‚¹æ•°è¿ç®—ä¸ä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼Ÿ</li>
</ol>
<p>åœ¨è®¾è®¡ç°ä»£æµ®ç‚¹å¤„ç†å•å…ƒçš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦å†è€ƒè™‘ä¸€äº›å†å²é—ç•™é—®é¢˜äº†ï¼Œå¯ä»¥è®¾è®¡æ–°çš„ç¡¬ä»¶ã€æ–°çš„æŒ‡ä»¤ä½“ç³»ç­‰ç­‰ã€‚å› æ­¤åœ¨ SSEï¼ŒAVX ç­‰è¿ç®—å•å…ƒä¸­ï¼Œå¯¹ INFï¼Œ NaN è¿™äº›æ•°å­—çš„å¤„ç†å®é™…ä¸Šåšåˆ°äº†ç¡¬ä»¶ä¸­:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-16.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-16.png" /></a></p>
<p>åœ¨æ–°çš„æµ®ç‚¹è¿ç®—å•å…ƒä¸­ï¼Œå¦‚æœå‡ºç°äº† subnormal / denormal æ•°ï¼Œç”šè‡³è¿è¿ç®—éƒ½ä¸ä¼šå¼€å§‹ï¼Œç›´æ¥æ ¹æ® DAZ / FTZ æ ‡å¿—ï¼Œä»¥åŠå¯¹åº”å¼‚å¸¸çš„æ©ç äº§ç”Ÿå¯¹åº”çš„ç»“æœï¼Œå¤§å¤§åŠ é€Ÿäº†å¼‚å¸¸å¤„ç†çš„æ•ˆç‡ã€‚å› æ­¤å¹¶ä¸ä¼šé‡åˆ°æ€§èƒ½éª¤é™çš„é—®é¢˜ã€‚</p>
<ol>
<li>ä¸ºä»€ä¹ˆ AMD CPU çš„ x87 å•å…ƒæ²¡æœ‰è¿™ç§ç°è±¡ï¼Ÿ</li>
</ol>
<p>åœ¨ä¸€ç¯‡ 2003 å¹´å¯¹ AMD Opteron CPU (é¦–ä¸ª 64 ä½ CPUï¼‰å¾®æ¶æ„çš„åˆ†ææŠ€æœ¯åšå®¢ Detailed Architecture of AMD's 64-bit core ä¸­ï¼Œæœ‰å¦‚ä¸‹çš„å™è¿°:</p>
<blockquote>
<p>The result of all AMD's x87 optimizations is that the Opteron literally runs circles around the Pentium 4 when it comes to x87 processing. It has removed large special purpose circuits for status processing and implemented a few small ones that handle the cases mentioned. The shift to SSE2 floating point however will make removed area overhead more important than the speed-ups.</p>
<p>AMD çš„æ‰€æœ‰ x87 ä¼˜åŒ–çš„ç»“æœæ˜¯ï¼ŒOpteron åœ¨ x87 å¤„ç†æ–¹é¢ç¡®å®æ¯” Pentium 4 æ›´èƒœä¸€ç­¹ ï¼ˆåŸæ–‡æ˜¯ï¼šåœ¨è·‘æ­¥æ—¶å¯ä»¥â€œå¥—åœˆâ€ï¼‰ã€‚å®ƒç§»é™¤äº†ç”¨äºçŠ¶æ€å¤„ç†çš„å¤§å‹ä¸“ç”¨ç”µè·¯ï¼Œå¹¶å®ç°äº†å‡ ä¸ªå¤„ç†ä¸Šè¿°æƒ…å†µçš„å°å‹ç”µè·¯ã€‚ç„¶è€Œï¼Œè½¬å‘ SSE2 æµ®ç‚¹å°†ä½¿æ¶ˆé™¤é¢ç§¯å¼€é”€æ¯”åŠ é€Ÿæ›´é‡è¦ã€‚</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´è‡ª AMD çš„ç¬¬ä¸€ä»£ 64 ä½ CPU èµ·ï¼ŒAMD å°±å¯¹ x87 FPU è¿›è¡Œäº†å¤§åˆ€é˜”æ–§çš„æ”¹é€ ï¼Œå°†å¾ˆå¤šå¼‚å¸¸å¤„ç†æœºåˆ¶ä»å¾®ç è¾…åŠ©å˜æˆäº†ç¡¬ä»¶åŠŸèƒ½ï¼Œä»è€Œæå¤§åœ°åŠ é€Ÿäº† x87 çš„æ€§èƒ½ã€‚åœ¨æˆ‘çš„ AMD Ryzen 7 7840HS ä¸Šç»è¿‡å®æµ‹ï¼Œå³ä½¿æ˜¯ x87 è¿ç®—ï¼Œä¹Ÿä¸ä¼šå‡ºç°æ€§èƒ½éª¤é™çš„é—®é¢˜ã€‚</p>
<p>å°½ç®¡å½“æ—¶ x87 FPU å·²ç»æ˜¯æ¯”è¾ƒå¤è€çš„å•å…ƒï¼ŒæŠ€æœ¯çš„ä¸»æµæ˜¯ä½¿ç”¨ SSE ï¼ˆæˆ–è€… AMD æ›´æ—©çš„ 3DNow!ï¼‰ç­‰æ–°çš„æµ®ç‚¹è¿ç®—æŒ‡ä»¤ï¼ŒAMD è¿˜æ˜¯å¯¹è¿™ä¸ªä¸èµ·çœ¼çš„æµ®ç‚¹å•å…ƒè¿›è¡Œäº†ç»†è‡´çš„ä¼˜åŒ–ï¼Œå¹¶ä¸”é¢†å…ˆäº† Intel 20 å¹´ã€‚åè§‚ Intelï¼Œæ˜æ˜å·²ç»çŸ¥é“è¿™ä¸ªé—®é¢˜ï¼Œè¿˜æŠŠå®ƒå†™è¿›äº†æ‰‹å†Œé‡Œï¼Œä½†æ˜¯å°±æ˜¯ä¸æ„¿æ„ä¼˜åŒ–è‡ªå·±çš„ç¡¬ä»¶ï¼Œè€Œæ˜¯å°†å…¶è´£ä»»æ¨ç»™ç¨‹åºå‘˜ï¼Œè¯´æ˜¯ç¨‹åºå‘˜è¿˜åœ¨ä½¿ç”¨ x87 æŒ‡ä»¤çš„é”™ï¼Œä»–ä»¬åº”è¯¥å‡çº§è‡ªå·±çš„æŠ€æœ¯æ ˆã€‚AMD å’Œ Intel å¯¹å¾…è¿™ä¸ªé—®é¢˜æ€åº¦çš„åå·®ï¼Œç»“åˆä¸¤å®¶ä¼ä¸šç›®å‰å‘å±•çš„ç°çŠ¶ï¼Œå®åœ¨ä»¤äººå”å˜˜ä¸å·²ã€‚</p>
<h3 id="å®éªŒ_1">å®éªŒ<a class="headerlink" href="#å®éªŒ_1" title="Permanent link">&para;</a></h3>
<ol>
<li>æ‰‹åŠ¨æ’å…¥éœ€è¦ Microcode Assist çš„æŒ‡ä»¤ cpuid</li>
</ol>
<p>æˆ‘å†™äº†ä¸‹é¢è¿™ä¸ªå°ç¨‹åºï¼Œä½¿ç”¨ cpuid æ¥å¼ºåˆ¶è§¦å‘ Machine Clearï¼Œå¹¶æœŸæœ›å¾—åˆ°åŸæœ¬æ­£å¸¸çš„è¿ç®—ï¼Œæ·»åŠ  Machine Clear ä¹‹åæ€§èƒ½é™ä½çš„ç°è±¡</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">trigger_machine_clear</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">eax</span><span class="p">,</span><span class="w"> </span><span class="n">ebx</span><span class="p">,</span><span class="w"> </span><span class="n">ecx</span><span class="p">,</span><span class="w"> </span><span class="n">edx</span><span class="p">;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="k">asm</span><span class="w"> </span><span class="k">volatile</span><span class="p">(</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">        </span><span class="s">&quot;cpuid&quot;</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;=a&quot;</span><span class="p">(</span><span class="n">eax</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;=b&quot;</span><span class="p">(</span><span class="n">ebx</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;=c&quot;</span><span class="p">(</span><span class="n">ecx</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;=d&quot;</span><span class="p">(</span><span class="n">edx</span><span class="p">)</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="p">}</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span><span class="c1">// Example function that performs floating point operations</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.00000001</span><span class="p">;</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1e8</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="cp">#ifdef MACHINE_CLEAR</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">        </span><span class="n">trigger_machine_clear</span><span class="p">();</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="cp">#endif</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="p">}</span>
</span></code></pre></div>
<p>ç»“æœå¦‚ä¸‹:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-17.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-17.png" /></a></p>
<p>å¯ä»¥çœ‹å‡ºç»“æœç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼ŒåŸæœ¬ 0.3s å®Œæˆçš„è¿ç®—ï¼Œç°åœ¨éœ€è¦ 4.2s æ‰èƒ½å®Œæˆï¼Œæ…¢äº†è¶…è¿‡ 10 å€ã€‚åœ¨ eax = 0 æ—¶ï¼Œcpuid æŒ‡ä»¤åªæ˜¯å¾€å¯„å­˜å™¨é‡Œå†™å…¥ GenuineIntel è¿™ä¸ªå­—ç¬¦ä¸²è€Œå·²ï¼ˆå¯ä»¥å‚è€ƒæŠ¥å‘Šæ¥ä¸‹æ¥çš„éƒ¨åˆ†ï¼‰ï¼Œå¾®ç æ“ä½œ uops æ•°é‡è¦æ¯”æµ®ç‚¹æ•°å¼‚å¸¸å¤„ç†å°‘ï¼Œå› æ­¤å¹¶æ²¡æœ‰ç›¸å·®åƒå‡ºç° x87 æµ®ç‚¹æ•°å¼‚å¸¸é‚£ä¹ˆå¤šå€ã€‚</p>
<ol>
<li>ä½¿ç”¨ Intel VTune Profiler è¿›è¡Œæ€§èƒ½åˆ†æ</li>
</ol>
<p>Intel VTune Profiler å¯¹ Machine Clear å’Œ FP Assists çš„ä»‹ç»å’Œä¼˜åŒ–å»ºè®®:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-18.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-18.png" /></a></p>
<p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡º Intel å®é™…ä¸Šæ˜¯çŸ¥é“ x87 å¯¹äº denormal æ•°å¤„ç†çš„æ€§èƒ½é—®é¢˜çš„ï¼Œå®ƒç»™å‡ºçš„å»ºè®®å°±æ˜¯ä¸è¦ç”¨ x87.</p>
<p>åœ¨è¿›è¡Œæœ‰æµ®ç‚¹æ•°å¼‚å¸¸ï¼ˆsubnormalï¼‰çš„å®éªŒæ—¶ï¼ŒVTune Profiler æµ‹é‡å‡ºè¿™æ¡å…³é”®æŒ‡ä»¤çš„ CPI ç”šè‡³è¾¾åˆ°äº† 57.5ï¼Œè¯´æ˜è¿™æ¡æŒ‡ä»¤å°¤å…¶åœ°æ…¢:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-19.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-19.png" /></a></p>
<p>è€Œå¦‚æœä¸å‡ºç°å¼‚å¸¸çš„ normal æƒ…å†µï¼Œé‚£ä¹ˆæœ€æ…¢çš„æŒ‡ä»¤å°±æ˜¯å—åˆ¶äºè¿ç®—çš„ fmul, ä½† CPI ä¹Ÿä»…ä»…åªæœ‰ 8.6, ç›¸è¾ƒ 57.5 å°å¾ˆå¤š:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-20.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-20.png" /></a></p>
<h2 id="ä¸€ç§æœ‰åŠ›çš„éªŒè¯æ–¹æ³•">ä¸€ç§æœ‰åŠ›çš„éªŒè¯æ–¹æ³•<a class="headerlink" href="#ä¸€ç§æœ‰åŠ›çš„éªŒè¯æ–¹æ³•" title="Permanent link">&para;</a></h2>
<ol>
<li>ä½¿ç”¨ Red Unlock è§£é”ä½¿ç”¨ Intel Goldmont å¾®æ¶æ„çš„ CPU</li>
</ol>
<p>å¦‚æœé—®é¢˜å‡ºåœ¨å¾®ç è¾…åŠ©ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠå¾®ç æœºåˆ¶æ”¹æ‰ä¸å°±å¥½äº†ï¼Ÿå°ç™½è€å¸ˆè¯´è¿‡ <code>If it runs, it can be hacked</code>. çœ‹ä¼¼åšä¸å¯æ‘§çš„å•†ä¸šæœºå¯†â€”â€”å¾®ç ï¼Œåˆæ€èƒ½é€ƒè„±è¢«ç ´è§£çš„å‘½è¿å‘¢ï¼ŸChip Red Pill å›¢é˜Ÿåœ¨ 2020 å¹´æˆåŠŸç ´è§£äº† Intel Goldmont å¾®æ¶æ„ CPU çš„å¾®ç ï¼Œè·å–äº†å®Œæ•´çš„ MSROM dumpï¼Œåˆ†æå‡ºäº†å¾®ç æŒ‡ä»¤çš„ç»“æ„ä¸åŠŸèƒ½ï¼Œç”šè‡³è¿˜å‘ç°äº†ä¿®æ”¹å¾®ç çš„æ–¹æ³•ã€‚è¿™ä½¿å¾—æˆ‘ä»¬çœ‹ä¼¼ç–¯ç‹‚çš„æƒ³æ³•æˆä¸ºäº†å¯èƒ½ã€‚æ‰€ä»¥åœ¨è¿™ä¸€éƒ¨åˆ†æˆ‘æƒ³è®¨è®ºä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿä¿®æ”¹å¾®ç ï¼Œè¯¥å¦‚ä½•è¿›ä¸€æ­¥è®¤è¯æˆ‘ä»¬çš„çŒœæƒ³ã€‚</p>
<ol>
<li>é€šè¿‡ hook åŠ¨æ€æµ‹è¯• x87 FPU å¼‚å¸¸æ—¶æ‰€è°ƒç”¨çš„å¾®ç åŒºåŸŸ</li>
</ol>
<p>å°½ç®¡æœ‰å®Œæ•´çš„å¾®ç å†…å®¹ï¼Œx86 æŒ‡ä»¤çš„å¾®ç ä¹‹é—´çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯å¾®ç æŒ‡ä»¤çš„å…¥å£ç‚¹ä»æœªæ­æ™“ã€‚
æƒ³è¦è·å¾— x86 æŒ‡ä»¤ï¼Œæ¯”å¦‚ div ç­‰æŒ‡ä»¤çš„å…·ä½“å…¥å£ï¼Œæœ‰ä¸¤ç§æ–¹å¼:</p>
<p>ç¬¬ä¸€ç§æ˜¯é™æ€åˆ†æ: xxx æåˆ°ï¼Œx86 æŒ‡ä»¤çš„å¾®ç å…¥å£ä¸»è¦ä½äºå¾®ç æ–‡ä»¶ U0-U1000 çš„ä½ç½®ï¼Œä¸”åœ¨å¾®ç å†…éƒ¨æ— è¯¥åœ°å€çš„å¼•ç”¨ã€‚åˆ©ç”¨ Ghidra åæ±‡ç¼–ä»£ç ï¼Œé«˜æ‰‹å¯ä»¥ç›´æ¥é€šè¿‡é€†å‘çš„ç»éªŒå’Œå¯¹ x86 æŒ‡ä»¤é›†ææ·±çš„ç†è§£ï¼Œç›´æ¥æ¨æµ‹å¯¹åº”çš„æŒ‡ä»¤ã€‚æ¯”å¦‚ä¸€äº›ä¼šæ”¹åŠ¨å¯„å­˜å™¨çš„æŒ‡ä»¤ï¼Œå°±å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¨æµ‹å‡ºæ¥ã€‚ä»¥ cpuid æŒ‡ä»¤ä¸ºä¾‹ï¼Œè¯¥æŒ‡ä»¤æœ‰ä¸€éšè—æ“ä½œæ•° eaxï¼Œè‹¥ eax == 0ï¼Œåˆ™ä¼šå‘ ebx, ecx, edx è¿™ä¸‰ä¸ªå¯„å­˜å™¨ä¸­å†™å…¥ GenuineIntel å­—ç¬¦ä¸²ï¼Œä»£è¡¨ CPU çš„ç”Ÿäº§å‚å•†ã€‚åœ¨ Ghidra åæ±‡ç¼–çš„ä»£ç ä¸­ï¼Œå¯ä»¥å¾ˆæ¸…æ™°åœ°çœ‹å‡ºè¿™éƒ¨åˆ†çš„é€»è¾‘:</p>
<p><a class="glightbox" href="../../../../assets/x87/image-21.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="alt text" src="../../../../assets/x87/image-21.png" /></a></p>
<p>é€šè¿‡ç«‹å³æ•°ä»¥åŠå¯¹å¯„å­˜å™¨çš„æ“ä½œï¼Œä¾¿å¯ä»¥æ¨æµ‹å‡ºè¯¥å¾®ç æ“ä½œå±äº cpuid æŒ‡ä»¤ã€‚</p>
<p>è¿™ç§æ–¹æ³•å¯¹åˆ†æè€…çš„è¦æ±‚æé«˜ï¼Œä¸”å¾®ç ä»æœ‰å¾ˆå¤šç›®å‰å°šæœªæ¢æ˜çš„æ“ä½œï¼ŒGhidra åæ±‡ç¼–å‡ºçš„é€»è¾‘ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œå› æ­¤å¾ˆéš¾åˆ†æå‡ºç»“æœã€‚æˆ‘æƒ³è¿™ä¹Ÿæ˜¯åŸç ´è§£å›¢é˜Ÿä»…ä»…å…¬å¼€äº†æå°‘æ•° x86 æŒ‡ä»¤å…¥å£ç‚¹çš„åŸå› ã€‚</p>
<p>æˆ‘æœ€å¼€å§‹ä¹Ÿæƒ³è¿‡ç¡¬ç€å¤´çš®ç›´æ¥å»é€†å‘ï¼Œå¹¶ä¸”æƒ³åˆ°äº†ä¸‹é¢çš„ä¸¤ç§æ€è·¯:</p>
<ol>
<li>ä»ç«‹å³æ•°å…¥æ‰‹</li>
</ol>
<p>åœ¨ hard_imm.txt ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒIEEE 754 ç¼–ç çš„ 32 ä½æµ®ç‚¹æ•° INF 0x7f800000 å’Œ NaN 0x7fc0000 éƒ½å­˜åœ¨ï¼Œå¦‚æœèƒ½æ‰¾åˆ°å¯¹è¿™äº›ç«‹å³æ•°çš„å¼•ç”¨ï¼Œæˆ–è®¸å°±èƒ½æ‰¾åˆ°ä¸æµ®ç‚¹æ•°å¤„ç†ç›¸å…³çš„å¾®ç æ“ä½œã€‚</p>
<p>å¯æƒœçš„æ˜¯ï¼Œç›´æ¥æœç´¢è¿™äº›ç«‹å³æ•°ï¼Œè¦ä¹ˆæ˜¯æ— ç»“æœï¼Œè¦ä¹ˆæ˜¯æ‰¾ä¸åˆ°æœ‰æ„ä¹‰çš„å¾®ç æ“ä½œã€‚è¿™æ˜¯å› ä¸ºåœ¨å¾®ç ç¨‹åºä¸­ï¼Œç”±äºç»å¸¸è¦è¯»å–å’Œè®¾ç½®çŠ¶æ€ä½ï¼Œé‡Œé¢å­˜åœ¨å¤§é‡çš„ä½è¿ç®—ï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´ INF å’Œ NaN çš„åˆ¤æ–­å¯èƒ½æ˜¯é€šè¿‡å¤šæ¬¡ä½è¿ç®—è¿›è¡Œæ£€æµ‹çš„ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¸ç«‹å³æ•°è¿›è¡Œæ¯”è¾ƒã€‚æˆ‘æœç´¢äº†ç«‹å³æ•°çš„ä¸€éƒ¨åˆ†ï¼Œæ¯”å¦‚ 0x7ff, 0x7fc è¿™æ ·çš„ç«‹å³æ•°ï¼Œä»¥åŠ 0x (åè¿›åˆ¶ 52) è¿™æ ·çš„åç§»é‡ï¼Œä»æœªæ‰¾åˆ°ã€‚</p>
<p>æˆ‘è¿˜æœç´¢äº† Pi è¿™æ ·çš„å¸¸æ•°ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ x87 ä¾æ—§æ˜¯ç‹¬ç«‹äº x86 å¤„ç†å™¨çš„æµ®ç‚¹å•å…ƒï¼Œä¹Ÿå°±æ˜¯ 8087, 80287 æ—¶ä»£ï¼ŒPi, e, ln2 è¿™æ ·çš„å¸¸æ•°éƒ½æ˜¯ç¼–ç åœ¨ x87 ROM å½“ä¸­çš„ï¼Œç”šè‡³æ‰¾åˆ°çˆ±å¥½è€…æ ¹æ® die shot æ¨æµ‹ ROM å†…å®¹çš„æ–‡ç« : . ä½†æ˜¯ï¼Œè¿™äº›å¸¸æ•°å¹¶æœªç¼–ç äºå¾®ç  ROM ä¸­ï¼Œæˆ–è®¸å·²ç»åšåœ¨è¿ç®—å•å…ƒä¸­äº†ã€‚</p>
<ol>
<li>ä»å¼‚å¸¸å…¥æ‰‹</li>
</ol>
<p>åŸç ´è§£å›¢é˜Ÿåœ¨å…¬å¸ƒçš„ä»£ç ä¸­æ‰¾åˆ°äº†ç”Ÿæˆ #GP, #UD, #MC è¿™ä¸‰ä¸ªå¼‚å¸¸çš„å¾®ç å…¥å£ç‚¹ï¼Œå¹¶æŒ‡å‡º sigevent æ“ä½œä¸å…¶ç›´æ¥ç›¸å…³ï¼Œä½† sigevent çš„ç«‹å³æ•°ä¸å¼‚å¸¸çš„å…·ä½“å…³ç³»å°šä¸æ˜æ™°ã€‚</p>
<p>ä¸ x87 FPU ç›¸å…³çš„å¼‚å¸¸æœ‰ #OF æº¢å‡ºå¼‚å¸¸ï¼Œä»¥åŠ # x87 FPU å¼‚å¸¸ã€‚</p>
<p>ç„¶è€Œï¼Œæœç´¢å…¨éƒ¨çš„ sigevent æ“ä½œï¼Œå¯ä»¥å‘ç°åé¢çš„ç«‹å³æ•°ä¸å°½ç›¸åŒï¼Œä¸èƒ½é€šè¿‡æŸä¸ªå¼‚å¸¸çš„é¢‘æ¬¡åˆ†æå‡ºè¿™ä¸ªå¼‚å¸¸å¯èƒ½æ˜¯å“ªä¸ªã€‚</p>
<p>ç»¼ä¸Šï¼Œè¿™ä¸¤ç§æ€è·¯è™½ç„¶å¾ˆæœ‰å¸Œæœ›ï¼Œä½†è¿˜æ˜¯æå…¶å›°éš¾çš„ï¼Œæœ€ç»ˆæˆ‘æ²¡æœ‰å¾—åˆ°ç»“æœã€‚</p>
<p>ç¬¬äºŒç§æ˜¯åŠ¨æ€æµ‹è¯•: xxxx æåˆ°ï¼Œå¯ä»¥ä½¿ç”¨æ’æ¡©+æ¨¡ç³Šæµ‹è¯•çš„æ–¹å¼æ¥æ‰¾å…¥å£ã€‚e è¿™ç§æ–¹å¼é¦–å…ˆè®¾è®¡äº†ä¸€æ®µå¾®ç æ“ä½œâ€œå‡½æ•°â€ï¼Œå¯ä»¥è¢«è°ƒç”¨ï¼Œä¸”å¯é€šè¿‡æ€§èƒ½å¯„å­˜å™¨è§‚æµ‹å‡ºæ˜¯å¦è¢«æ‰§è¡Œï¼Œç„¶åä¸æ–­éå†å…¥å£ç‚¹ï¼Œå°†å…¥å£ç‚¹ä¿®æ”¹ä¸ºè·³è½¬åˆ°è¯¥æŒ‡ä»¤çš„å¾®ç æ“ä½œã€‚è¿™æ ·ä¸€æ—¦è®¾è®¡çš„å‡½æ•°è¢«è°ƒç”¨ï¼Œå°±è¯´æ˜æ‰¾åˆ°äº†è¯¥ x86 æŒ‡ä»¤å¯¹åº”çš„å…¥å£ç‚¹ã€‚</p>
<p>æˆ‘è®¤ä¸ºè¿™ç§æ–¹å¼è™½ç„¶æš´åŠ›ï¼Œä½†åº”è¯¥ä¹Ÿæ˜¯ç›®å‰çš„å”¯ä¸€å¯è¡Œè§£äº†ã€‚ä¸è¿‡è¿™ç§æ–¹æ³•éœ€è¦æœ‰ä¸€æ¬¾ Intel Goldmont å¾®æ¶æ„çš„ CPU å¹¶ä¸”è¿›è¡Œ Red Unlockï¼Œåœ¨ UEFI ä¸­è¿›è¡Œæµ‹è¯•ï¼Œæ‰€ä»¥æˆ‘æš‚æ—¶è¿˜æ— æ³•è¿›è¡Œæµ‹è¯•ã€‚ï¼ˆå¥½åœ¨ Goldmont æœ‰å¾ˆå¤šä½ç«¯äº§å“çº¿çš„ CPUï¼Œæƒ³è¦è·å–ä¸€ä¸ªæµ‹è¯•ç”¨çš„ç¡¬ä»¶å¯ä»¥åœ¨ 200 å…ƒä»¥å†…è§£å†³ï¼‰</p>
<ol>
<li>ä¿®æ”¹ç›¸å…³å¾®ç ï¼Œå–æ¶ˆå¼‚å¸¸å¤„ç†</li>
</ol>
<p>æ›¾ä»Šæˆ‘ä»¬è®¤ä¸ºå¾®ç è¿™ç§ä¸œè¥¿æ˜¯ä¸å¯èƒ½ä¿®æ”¹çš„ï¼Œä½†ç°åœ¨å¾®ç å†…å®¹å·²ç»è¢«ç ´è§£å¹¶åˆ†æå‡ºæ¥ï¼Œè¿å¸¦ç€ Intel å®˜æ–¹å¯¹å¾®ç æ›´æ–°çš„ç¨‹åºé€»è¾‘ä¹ŸåŒæ ·è¢«ç ´è§£ï¼Œé‚£è¿˜æœ‰ä»€ä¹ˆä¸å¯èƒ½çš„å‘¢ï¼Ÿæ­¤å¤–ï¼ŒåŸç ´è§£å›¢é˜Ÿç”šè‡³è¿˜ä»ä¸€æ¡ç±»ä¼¼ jmp rax ï¼ˆå¯ä»¥åœ¨å¾®ç ä¸­åšä»»æ„æ§åˆ¶æµè·³è½¬ï¼‰çš„å¾®ç æ“ä½œï¼ŒæŒ–æ˜å‡ºäº†ä¸¤æ¡éšè— x86 æŒ‡ä»¤ã€‚åˆ©ç”¨è¿™ä¸¤æ¡æŒ‡ä»¤ï¼Œå³ä½¿æ²¡æœ‰ Red Unlock æ¼æ´ï¼Œä¹Ÿå¯ä»¥åœ¨ UEFI ä¸‹é¢è¿›è¡Œå¾®ç ä¿®æ”¹ã€‚</p>
<p>è¿™æ ·ä¸€æ¥ï¼Œåªè¦æ‰¾åˆ° x87 å¼‚å¸¸ç›¸å…³çš„å¾®ç å¤„ç†æ“ä½œï¼Œç„¶åå°†å…¶ä¿®æ”¹æˆç›´æ¥ uret ï¼ˆå¾®ç é€€å‡ºï¼‰ï¼Œæˆ–è€…è·³è½¬åˆ° cpuid çš„å¾®ç ç¨‹åºã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æ’æ¡©çš„ç¡®æ‰¾åˆ°äº†å¯¹åº”çš„å¾®ç ç¨‹åºï¼Œå¹¶ä¸”æˆåŠŸä¿®æ”¹äº† CPU å¯¹ x87 å¼‚å¸¸å¤„ç†çš„è¡Œä¸ºï¼Œé‚£ä¹ˆå°±è¯æ®ç¡®å‡¿ï¼Œå¯ä»¥å¼•è¯æˆ‘ä»¬çš„çŒœæƒ³äº†ã€‚</p>
<ol>
<li>é‡æ–°è¿›è¡Œå®éªŒæµ‹è¯•</li>
</ol>
<p>åœ¨ä¿®æ”¹å¾®ç ï¼ˆä¸»è¦æ˜¯è®©å¾®ç æ“ä½œå˜å°‘ï¼‰ä¹‹åï¼Œæˆ‘ä»¬å°†é¢„æœŸè§‚å¯Ÿåˆ°è¿›è¡Œ denormal / subnormal ç›¸å…³æµ®ç‚¹æ•°è¿ç®—æ—¶ï¼Œx87 æŒ‡ä»¤é€Ÿåº¦å˜å¿«ï¼Œä¸”ä¸ sse æŒ‡ä»¤æ’å…¥ cpuid æŒ‡ä»¤ç›¸è¿‘ã€‚
è¿™æ ·ï¼Œæˆ‘ä»¬ä¾¿ä¸ä»…å¯ä»¥è¯æ˜ x87 æŒ‡ä»¤è€—æ—¶å¼‚å¸¸åŸå› ä¸ Intel CPU å†…éƒ¨çš„ Microcode Assist æœºåˆ¶æœ‰å…³ï¼Œè¿˜å¯è·çŸ¥å¤„ç† x87 å¼‚å¸¸çš„å¾®ç éå¸¸å¤æ‚ï¼Œéœ€è¦æé«˜çš„å‘¨æœŸæ•°æ‰å¯ä»¥å®Œæˆã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“<a class="headerlink" href="#æ€»ç»“" title="Permanent link">&para;</a></h2>
<p>æµ®ç‚¹æ•°è¿ç®—çš„æ€§èƒ½é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨åº•æ•°è¾ƒå¤§æ—¶ï¼Œå®é™…ä¸Šæ˜¯ç”±äº x87 æµ®ç‚¹æ•°å•å…ƒå¤„ç†å¼‚å¸¸ï¼ˆå¦‚ INF å’Œ NaNï¼‰æ—¶ä¾èµ–å¾®ç è¾…åŠ©ï¼Œå¼•èµ·çš„ Machine Clear æ‰“æ–­æŒ‡ä»¤è§£ç å’Œæµæ°´çº¿ä¹±åºæ‰§è¡Œï¼Œè‡´ä½¿ CPU çš„æŒ‡ä»¤çº§å¹¶è¡Œä¸§å¤±ï¼Œä»è€Œæ˜¾è‘—é™ä½äº†æ€§èƒ½ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒSSE å’Œ AVX æŒ‡ä»¤é›†é€šè¿‡ç¡¬ä»¶ä¼˜åŒ–è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼Œé¿å…äº†æ€§èƒ½ç“¶é¢ˆã€‚åœ¨ AMD çš„å¤„ç†å™¨ä¸­ï¼Œx87 çš„å¼‚å¸¸å¤„ç†å¾—åˆ°äº†æ›´å¥½çš„ä¼˜åŒ–ï¼Œå› æ­¤æ€§èƒ½æœªå—æ˜æ˜¾å½±å“ã€‚</p>
<p>ä¸Šé¢çš„å®éªŒä¸åˆ†æå¯å‘æˆ‘ä»¬åœ¨æœªæ¥çš„ç¼–ç¨‹æ—¶:</p>
<ul>
<li>å°½å¯èƒ½ä½¿ç”¨æ›´æ–°çš„ç¼–è¯‘å™¨ï¼Œä»¥åŠæœ€æ–°çš„ CPU ç‰¹æ€§</li>
<li>åœ¨é’ˆå¯¹æŸæ¬¾ CPU è¿›è¡Œä¼˜åŒ–æ—¶ï¼Œå¯ä»¥å…ˆå¯¹å…¶å¾®æ¶æ„è¿›è¡Œå‰–æ</li>
<li>é‡åˆ°æ€§èƒ½é—®é¢˜æ—¶ï¼Œå¤šä½¿ç”¨ Profiler æ¯”å¦‚ perf, Intel VTune æ¥åˆ†æé—®é¢˜</li>
</ul>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®<a class="headerlink" href="#å‚è€ƒæ–‡çŒ®" title="Permanent link">&para;</a></h2>
<ul>
<li>8087 åå¤„ç†å™¨ç»“æ„æ·±å…¥æ¢ç©¶: https://www.righto.com/2018/08/inside-die-of-intels-8087-coprocessor.html</li>
<li>8086 ä¸ 8087 å¤„ç†å™¨çš„åŒæ­¥: https://stackoverflow.com/questions/42543905/what-are-8086-esc-instruction-opcodes</li>
<li>Intel æµ®ç‚¹æ•°å‚è€ƒæ‰‹å†Œ: https://www.intel.com/content/www/us/en/developer/articles/technical/floating-point-reference-sheet-for-intel-architecture.html</li>
<li>Intel 64 ä¸ IA-32 ä¼˜åŒ–æ‰‹å†Œ: https://www.intel.com/content/www/us/en/content-details/671488/intel-64-and-ia-32-architectures-optimization-reference-manual-volume-1.html</li>
<li>AMD Opteron æ¶æ„æ¢ç©¶: https://web.archive.org/web/20241002032238/http://www.chip-architect.com/news/2003_09_21_Detailed_Architecture_of_AMDs_64bit_Core.html</li>
</ul>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="æœ€åæ›´æ–°">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2025å¹´1æœˆ14æ—¥ 22:56:58</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="åˆ›å»ºæ—¥æœŸ">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2025å¹´1æœˆ14æ—¥ 22:56:58</span>
  </span>

    
    
    
  </aside>



  



<h2 id="__comments" class="no-number">è¯„è®º</h2>
<!-- Insert generated snippet here -->
<script src="https://giscus.app/client.js" data-repo="YooLc/notes" data-repo-id="R_kgDONk4Byg"
    data-category="Announcements" data-category-id="DIC_kwDONk4Bys4ClrHG" data-mapping="pathname" data-strict="0"
    data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme"
    data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async>
    </script>

<!-- Synchronize Giscus theme with palette -->
<script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate" ? "dark" : "light"
        giscus.setAttribute("data-theme", theme)
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function () {
        var ref = document.querySelector("[data-md-component=palette]")
        ref.addEventListener("change", function () {
            var palette = __md_get("__palette")
            if (palette && typeof palette.color === "object") {
                var theme = palette.color.scheme === "slate" ? "dark" : "light"

                /* Instruct Giscus to change theme */
                var frame = document.querySelector(".giscus-frame")
                frame.contentWindow.postMessage(
                    { giscus: { setConfig: { theme } } },
                    "https://giscus.app"
                )
            }
        })
    })
</script>

      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  å›åˆ°é¡µé¢é¡¶éƒ¨
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="é¡µè„š" >
        
          
          <a href="../../../09/12/blechley-park-trip/" class="md-footer__link md-footer__link--prev" aria-label="ä¸Šä¸€é¡µ: Blectchley Park æ¸¸è®°">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                ä¸Šä¸€é¡µ
              </span>
              <div class="md-ellipsis">
                Blectchley Park æ¸¸è®°
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../12/02/foss-inspiration/" class="md-footer__link md-footer__link--next" aria-label="ä¸‹ä¸€é¡µ: ğŸº Free as in free speech, not as in free beer">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                ä¸‹ä¸€é¡µ
              </span>
              <div class="md-ellipsis">
                ğŸº Free as in free speech, not as in free beer
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <!-- Copyright and theme information -->
<div class="md-copyright" style="width: 100%;">
    <div style="display: flex; justify-content: space-between; align-items: center">
        <div>
            
            <div class="md-copyright__highlight">
                YooLc ğŸ„¯ Copyleft 2024 - 2025
            </div>
            
            
            ä½¿ç”¨
            <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
                Material for MkDocs
            </a>
            æ„å»º
            
        </div>
        <div style="display: flex; align-items: center; height: 32px; width: fit-content;">
            <a href="https://notbyai.fyi/" target="_blank" rel="noopener noreferrer" style="margin-right: 10px;">
                <img src="/notes/assets/by-human-black.svg" alt="by-human" style="height: 32px; margin: 0;">
            </a>
            <a href="https://creativecommons.org/publicdomain/zero/1.0/?ref=chooser-v1" target="_blank"
                rel="license noopener noreferrer" style="margin-right: 3px;">
                <img style="height: 22px!important; margin: 0;"
                    src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt="">
            </a>
            <a href="https://creativecommons.org/publicdomain/zero/1.0/?ref=chooser-v1" target="_blank"
                rel="license noopener noreferrer">
                <img style="height: 22px!important; margin: 0;"
                    src="https://mirrors.creativecommons.org/presskit/icons/zero.svg?ref=chooser-v1" alt="">
            </a>
        </div>
    </div>
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["announce.dismiss", "content.code.copy", "content.code.select", "content.code.annotate", "navigation.footer", "navigation.tabs", "navigation.indexes", "navigation.sections", "navigation.indexes", "navigation.tracking", "navigation.path", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.top", "toc.follow", "content.action.edit", "search.suggest", "search.highlight", "search.share"], "search": "../../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.alicdn.com/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>